# -----------------------------------------------------------------------
#
#  Tokiwa Software GmbH, Germany
#
#  Source code of Fuzion webserver feature url_encoded
#
# -----------------------------------------------------------------------

module url_encoded is


  # Parse URL-encoded form data into a map
  #
  module parse_urlencoded_map(data String) lock_free.Map String String =>

    pairs := data.split "&"
    form_data := lock_free.Map String String .empty
    for p in pairs do
      nv := p.split "="
      name := encodings.percent.decode_as_str nv[0] .val.trim
      _ := form_data.put name (nv.count < 2 ? "" : encodings.percent.decode_as_str nv[1] .val)
    form_data


  # Strip non-alphanumeric characters from a string
  #
  module strip_non_alpha_numeric(s String) String =>
    String
      .from <| s
        .codepoints
        .map c->
          if c.is_ascii_alpha_num then c else "_"

